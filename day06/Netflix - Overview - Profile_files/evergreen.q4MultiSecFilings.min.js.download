(a=>{a.widget("evergreen.q4MultiSecFilings",a.evergreen.q4Sec,{options:{stockInfo:[],contentType:{itemsUrl:["/Services/SECFilingService.svc/GetEdgarFilingList","/feed/SECFiling.svc/GetEdgarFilingList"],yearsUrl:["/Services/SECFilingService.svc/GetEdgarFilingYearList","/feed/SECFiling.svc/GetEdgarFilingYearList"],itemsResultField:"GetEdgarFilingListResult",yearsResultField:"GetEdgarFilingYearListResult",buildParams:function(e){return{formGroupIdList:e.filingGroups.join(","),filingTypeList:e.filingTypes.join(","),excludeNoDocuments:e.excludeNoDocuments,includeHtmlDocument:e.includeHtmlDocument}},parseItem:function(e,t){return{id:t.FilingId,description:this._truncate(t.FilingDescription,e.titleLength),url:t.LinkToDetailPage,dateObj:new Date(t.FilingDate),year:new Date(t.FilingDate).getFullYear(),date:this._formatDate(t.FilingDate),agent:t.FilingAgentName,person:t.ReportPersonName,type:t.FilingTypeMnemonic,docs:a.map(t.DocumentList,function(e){return{docId:e.FilingDocumentId,docType:e.DocumentType,docUrl:e.Url.replace(/(\w+:)/,"")}})}}}},_fetchItems(e){var t,n=this,r=this.options,i=n._usePublic()?1:0,s=a.Deferred(),c=a.grep(this.currentTags,function(e){return 0<e.length}),o=this._usePublic()?{pageSize:r.limit||-1,pageNumber:r.skip,tagList:c.join("|"),includeTags:!0,year:r.fetchAllYears?-1:e,excludeSelection:r.excludeSelection?0:1}:{serviceDto:{ItemCount:r.limit||-1,StartIndex:r.skip,TagList:c,IncludeTags:!0},excludeSelection:r.excludeSelection?0:1,year:r.fetchAllYears?-1:e};return a.isArray(r.stockInfo)&&0!=r.stockInfo.length?(t=[],r.stockInfo.forEach(e=>{e=this._callApi(this.contentType.itemsUrl[i],a.extend(!0,this._buildParams(),this.contentType.buildParams.call(this,r),o,{exchange:e.Exchange,symbol:e.Symbol}));t.push(e)}),a.when.apply(a,t).done(function(){var e=[];if("success"===arguments[1])e=arguments[0][n.contentType.itemsResultField];else for(var t=0;t<arguments.length;t++)e=e.concat(arguments[t][0][n.contentType.itemsResultField]);var i=n._processItems(e),i=n._filterByYears(i);0!==r.docOrder&&void 0!==r.docOrder&&a.each(i,function(e,i){a.each(r.docOrder,function(e,t){a.grep(i.docs,function(e){return e.docType==t}).length||i.docs.push({docType:t,docUrl:"",docEmpty:!0})}),i.docs.sort(function(e,t){e=a.inArray(e.docType,r.docOrder),t=a.inArray(t.docType,r.docOrder);return e<t?-1:t<e?1:0})}),s.resolve(i)}),s):s.resolve([])},_processItems(e){var t=this,i=this.options,e=a.map(e,function(e){return t.contentType.parseItem.call(t,i,e)});return(e=a.grep(e,function(e){return(!i.minDate||e.dateObj>=i.minDate)&&(!i.maxDate||e.dateObj<=i.maxDate)})).sort(function(e,t){return(t.dateObj-e.dateObj)*(i.sortAscending?-1:1)}),e},_filterByYears(e){var i,t=this.options;return 0<t.numOfYears&&-1==year?((i=_.years||[]).length||(a.each(e,function(e,t){-1==a.inArray(t.year,i)&&i.push(t.year)}),t.numOfYears<i.length&&(i=i.slice(0,t.numOfYears))),a.grep(e,function(e){return!t.numOfYears||!i.length||-1<a.inArray(e.year,i)})):e}})})($tudio);